---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

1. Unzip and load data
```{r, echo=TRUE}
unzip("activity.zip")
ds<-read.csv("activity.csv")
summary(ds)

```

Explore for NA values and remove them
```{r}
tds<-na.omit(ds)

```

## What is mean total number of steps taken per day?


Summarizing total number of steps per day and make histogram
```{r, message=FALSE}
library(sqldf)
t1<-sqldf("select sum(steps) as step_sum, date from tds group by date")
hist(t1$step_sum, col = "red", xlab = "Total steps per day", main = "Steps per day")

```

```{r, echo=FALSE}
meanval<-mean(t1$step_sum)
medval<-median(t1$step_sum)
```
The mean value is `r meanval` and median is `r medval`

## What is the average daily activity pattern?

Average daily activity are on the next plot

```{r, echo=TRUE}
t2<-sqldf("select avg(steps) as step_avg, interval from tds group by interval")
mint<-t2[t2$step_avg == max(t2$step_avg),]$interval
plot(t2$interval, t2$step_avg,  type = 'l', xlab = '5-minute interval', ylab = 'Average steps',
     main = 'Average number of steps taken, averaged across all days')
```

And the maximum average value of steps are in `r mint` interval

## Imputing missing values
There are some missing values in data. At first we just calculate them:
```{r}
colSums(is.na(ds))
```

And second, fill in with some values


## Are there differences in activity patterns between weekdays and weekends?

To explore this difference we have to convert Date column from our dataset to Date format. Then we extract dayweeks from date and create weekday/weekend indicator

```{r}

tds$date<-as.Date(tds$date)
tds$wd<-format(tds$date,'%w')
tds$weekday <- ifelse((tds$wd  == 6 | tds$wd  == 0), 'weekend', 'weekday' )
tds$weekday <- as.factor(tds$weekday)
```
